import{r as h,l as oe,j as e}from"./app-hMjON_fH.js";import{d as se}from"./index-BEb-Ce8c.js";import{H as re}from"./html5-qrcode-scanner-GL9eTstI.js";var K;function ne(a){return a&&typeof a=="object"&&"default"in a?a.default:a}ne(oe);var d=h;ne(d);var T=se;function Z(){return(Z=Object.assign||function(a){for(var v=1;v<arguments.length;v++){var f=arguments[v];for(var p in f)Object.prototype.hasOwnProperty.call(f,p)&&(a[p]=f[p])}return a}).apply(this,arguments)}var X=d.createContext();X.displayName="InertiaPageContext";var Y=d.createContext();function ie(a){var v=a.children,f=a.initialPage,p=a.resolveComponent,g=a.titleCallback,w=a.onHeadUpdate,y=d.useState({component:a.initialComponent||null,page:f,key:null}),n=y[0],L=y[1],l=d.useMemo(function(){return T.createHeadManager(typeof window>"u",g||function(o){return o},w||function(){})},[]);if(d.useEffect(function(){T.Inertia.init({initialPage:f,resolveComponent:p,swapComponent:function(o){var u=o.component,c=o.page,x=o.preserveState;try{return L(function(m){return{component:u,page:c,key:x?m.key:Date.now()}}),Promise.resolve()}catch(m){return Promise.reject(m)}}})},[]),!n.component)return d.createElement(Y.Provider,{value:l},d.createElement(X.Provider,{value:n.page},null));var k=v||function(o){var u=o.Component,c=o.props,x=d.createElement(u,Z({key:o.key},c));return typeof u.layout=="function"?u.layout(x):Array.isArray(u.layout)?u.layout.concat(x).reverse().reduce(function(m,j){return d.createElement(j,Z({children:m},c))}):x};return d.createElement(Y.Provider,{value:l},d.createElement(X.Provider,{value:n.page},k({Component:n.component,key:n.key,props:n.page.props})))}Y.displayName="InertiaHeadContext",ie.displayName="Inertia";var ce=["children","as","data","href","method","preserveScroll","preserveState","replace","only","headers","queryStringArrayFormat","onClick","onCancelToken","onBefore","onStart","onProgress","onFinish","onCancel","onSuccess","onError"],C=function(){},de=d.forwardRef(function(a,v){var f=a.children,p=a.as,g=p===void 0?"a":p,w=a.data,y=w===void 0?{}:w,n=a.href,L=a.method,l=L===void 0?"get":L,k=a.preserveScroll,o=k!==void 0&&k,u=a.preserveState,c=u===void 0?null:u,x=a.replace,m=x!==void 0&&x,j=a.only,_=j===void 0?[]:j,D=a.headers,A=D===void 0?{}:D,F=a.queryStringArrayFormat,O=F===void 0?"brackets":F,M=a.onClick,$=M===void 0?C:M,q=a.onCancelToken,B=q===void 0?C:q,I=a.onBefore,R=I===void 0?C:I,V=a.onStart,Q=V===void 0?C:V,t=a.onProgress,r=t===void 0?C:t,s=a.onFinish,i=s===void 0?C:s,N=a.onCancel,b=N===void 0?C:N,S=a.onSuccess,z=S===void 0?C:S,H=a.onError,P=H===void 0?C:H,W=function(E,le){if(E==null)return{};var J,G,te={},ae=Object.keys(E);for(G=0;G<ae.length;G++)le.indexOf(J=ae[G])>=0||(te[J]=E[J]);return te}(a,ce),U=d.useCallback(function(E){$(E),T.shouldIntercept(E)&&(E.preventDefault(),T.Inertia.visit(n,{data:y,method:l,preserveScroll:o,preserveState:c??l!=="get",replace:m,only:_,headers:A,onCancelToken:B,onBefore:R,onStart:Q,onProgress:r,onFinish:i,onCancel:b,onSuccess:z,onError:P}))},[y,n,l,o,c,m,_,A,$,B,R,Q,r,i,b,z,P]);g=g.toLowerCase(),l=l.toLowerCase();var ee=T.mergeDataIntoQueryString(l,n||"",y,O);return n=ee[0],y=ee[1],g==="a"&&l!=="get"&&console.warn(`Creating POST/PUT/PATCH/DELETE <a> links is discouraged as it causes "Open Link in New Tab/Window" accessibility issues.

Please specify a more appropriate element using the "as" attribute. For example:

<Link href="`+n+'" method="'+l+'" as="button">...</Link>'),d.createElement(g,Z({},W,g==="a"?{href:n}:{},{ref:v,onClick:U}),f)});K=de;function xe({penukarans:a}){const[v,f]=h.useState(null),[p,g]=h.useState(null),[w,y]=h.useState(""),[n,L]=h.useState("desc"),[l,k]=h.useState(1),o=10,[u,c]=h.useState(!1),x=h.useRef(null),m=h.useRef(null),[j,_]=h.useState([]),[D,A]=h.useState(null);h.useEffect(()=>(u&&F(),()=>{M()}),[u]);const F=async()=>{try{const t=await re.getCameras();if(_(t),t.length===0){alert("Tidak ada kamera ditemukan."),c(!1);return}const s=t.find(i=>i.label.toLowerCase().includes("back")||i.label.toLowerCase().includes("rear")||i.label.toLowerCase().includes("environment"))??t[0];A(s.id),O(s.id)}catch(t){console.error(t),alert("Gagal mengakses kamera."),c(!1)}},O=async t=>{if(!x.current)return;const r=new re(x.current.id);m.current=r;try{await r.start({deviceId:{exact:t}},{fps:10,qrbox:{width:250,height:250},aspectRatio:1},async s=>{const i=s.trim();a.find(b=>b.id.toString()===i)?(y(i),k(1)):alert("Data penukaran tidak ditemukan."),await M(),c(!1)})}catch(s){console.error(s),alert("Gagal memulai scanner."),c(!1)}},M=async()=>{m.current&&(await m.current.stop(),await m.current.clear(),m.current=null)},$=()=>{if(j.length<=1)return;const r=(j.findIndex(i=>i.id===D)+1)%j.length,s=j[r].id;M().then(()=>{A(s),O(s)})},q=t=>{const r=t.status==="sudah diredeem"?"belum diredeem":"sudah diredeem";g(t.id),se.Inertia.put(`/admin/penukarans/${t.id}/status`,{status:r},{onSuccess:()=>g(null)})},B=h.useMemo(()=>{let t=a;if(w.trim()!==""){const r=w.toLowerCase();t=t.filter(s=>{var S,z,H,P;const i=(z=(S=s.user)==null?void 0:S.name)==null?void 0:z.toLowerCase().includes(r),N=(P=(H=s.voucher)==null?void 0:H.nama)==null?void 0:P.toLowerCase().includes(r),b=s.id.toString()===w.trim();return i||N||b})}return t.sort((r,s)=>new Date(n==="asc"?r.created_at:s.created_at)-new Date(n==="asc"?s.created_at:r.created_at)),t},[a,w,n]),I=Math.ceil(B.length/o),R=B.slice((l-1)*o,l*o),V=t=>{t>=1&&t<=I&&k(t)},Q=t=>new Intl.NumberFormat("id-ID").format(t);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mx-auto w-full max-w-[500px] min-h-screen bg-white",children:[e.jsxs("div",{className:"fixed top-0 left-1/2 -translate-x-1/2 max-w-[500px] w-full z-20 bg-main",children:[e.jsx("div",{className:"w-full h-max flex flex-row space-x-4 justify-start items-center px-4 py-2 bg-main",children:e.jsxs("div",{className:"w-full h-max flex flex-row space-x-4 items-center justify-start",children:[e.jsx("button",{className:"shrink-0 w-6 h-6",onClick:()=>window.history.back(),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"white",viewBox:"0 0 24 24",className:"w-6 h-6",children:e.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),e.jsx("div",{className:"font-utama text-white font-bold text-lg",children:"Kelola Penukaran"})]})}),e.jsx("div",{className:"sticky top-[44px] z-10 bg-white shadow px-4 py-3 border-b border-gray-200",children:e.jsxs("div",{className:"flex space-x-4 items-center",children:[e.jsxs("div",{className:"flex-grow h-9 flex flex-row items-center justify-center pr-2 py-2 rounded-lg bg-neutral-100 border-2 border-gray-200",children:[e.jsx("input",{type:"text",placeholder:"Masukkan id penukaran/nama user/voucher...",value:w,onChange:t=>{y(t.target.value),k(1)},className:"bg-transparent border-none flex-grow focus:ring-0 focus:outline-none text-sm placeholder-gray-400"}),e.jsx("button",{onClick:()=>c(!0),className:"text-main",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",className:"w-5 h-5",viewBox:"0 0 16 16",children:[e.jsx("path",{d:"M0 .5A.5.5 0 0 1 .5 0h3a.5.5 0 0 1 0 1H1v2.5a.5.5 0 0 1-1 0zm12 0a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-1 0V1h-2.5a.5.5 0 0 1-.5-.5M.5 12a.5.5 0 0 1 .5.5V15h2.5a.5.5 0 0 1 0 1h-3a.5.5 0 0 1-.5-.5v-3a.5.5 0 0 1 .5-.5m15 0a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1 0-1H15v-2.5a.5.5 0 0 1 .5-.5M4 4h1v1H4z"}),e.jsx("path",{d:"M7 2H2v5h5zM3 3h3v3H3zm2 8H4v1h1z"}),e.jsx("path",{d:"M7 9H2v5h5zm-4 1h3v3H3zm8-6h1v1h-1z"}),e.jsx("path",{d:"M9 2h5v5H9zm1 1v3h3V3zM8 8v2h1v1H8v1h2v-2h1v2h1v-1h2v-1h-3V8zm2 2H9V9h1zm4 2h-1v1h-2v1h3zm-4 2v-1H8v1z"}),e.jsx("path",{d:"M12 9h2V8h-2z"})]})})]}),e.jsx("button",{onClick:()=>L(n==="asc"?"desc":"asc"),className:"flex items-center space-x-2 text-sm text-gray-700 hover:text-main transition",children:n==="asc"?e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",className:"w-6 h-6 text-main",children:[e.jsx("path",{d:"M6.75 2.25A.75.75 0 017.5 3v.75h9V3a.75.75 0 011.5 0v.75h.75A2.25 2.25 0 0121 6v12a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 18V6a2.25 2.25 0 012.25-2.25H6V3a.75.75 0 01.75-.75zM4.5 8.25v9.75a.75.75 0 00.75.75h13.5a.75.75 0 00.75-.75V8.25H4.5z"}),e.jsx("path",{fillRule:"evenodd",d:"M12 16a.75.75 0 01-.75-.75v-3.69l-1.22 1.22a.75.75 0 11-1.06-1.06l2.5-2.5a.75.75 0 011.06 0l2.5 2.5a.75.75 0 11-1.06 1.06l-1.22-1.22v3.69A.75.75 0 0112 16z",clipRule:"evenodd"})]}):e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",className:"w-6 h-6 text-main",children:[e.jsx("path",{d:"M6.75 2.25A.75.75 0 017.5 3v.75h9V3a.75.75 0 011.5 0v.75h.75A2.25 2.25 0 0121 6v12a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 18V6a2.25 2.25 0 012.25-2.25H6V3a.75.75 0 01.75-.75zM4.5 8.25v9.75a.75.75 0 00.75.75h13.5a.75.75 0 00.75-.75V8.25H4.5z"}),e.jsx("path",{fillRule:"evenodd",d:"M12 12a.75.75 0 01.75.75v3.69l1.22-1.22a.75.75 0 111.06 1.06l-2.5 2.5a.75.75 0 01-1.06 0l-2.5-2.5a.75.75 0 111.06-1.06l1.22 1.22v-3.69A.75.75 0 0112 12z",clipRule:"evenodd"})]})})]})})]}),e.jsx("div",{className:"pt-16 p-4 grid grid-cols-1 gap-3 mt-12",children:R.length>0?R.map(t=>{var r,s,i,N,b,S,z,H,P,W,U;return e.jsxs("div",{className:"bg-white rounded-lg shadow p-3 flex flex-col space-y-2",children:[e.jsxs("div",{className:"flex items-start space-x-3 cursor-pointer",onClick:()=>f(v===t.id?null:t.id),children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-gray-100 flex items-center justify-center overflow-hidden shrink-0",children:(r=t.voucher)!=null&&r.gambar?e.jsx("img",{src:`/storage/${t.voucher.gambar}`,alt:t.voucher.nama,className:"w-12 h-12 object-cover"}):e.jsx("div",{className:"text-xs text-gray-400 px-1 text-center",children:"No Image"})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("div",{className:`text-sm font-semibold text-gray-800 ${v===t.id?"break-words":"line-clamp-3"}`,children:((s=t.voucher)==null?void 0:s.nama)||"Voucher tidak ditemukan"})}),e.jsx("div",{children:e.jsx("span",{className:`text-xs font-semibold px-2 py-0.5 rounded-full ${t.status==="sudah diredeem"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:t.status})})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center text-yellow-600 space-x-1 text-sm font-medium",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 16 16",className:"w-4 h-4 text-yellow-500",children:e.jsx("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M5.5 4.002V12h1.283V9.164h1.668C10.033 9.164 11 8.08 11 6.586c0-1.482-.955-2.584-2.538-2.584zm2.77 4.072c.893 0 1.419-.545 1.419-1.488s-.526-1.482-1.42-1.482H6.778v2.97z"})}),e.jsx("span",{children:Q(t.poin_dipakai)})]}),e.jsxs("button",{onClick:()=>q(t),disabled:p===t.id,className:`text-xs px-3 py-1 rounded transition ${t.status==="sudah diredeem"?"bg-rose-500 hover:bg-rose-600 text-white":"bg-teal-500 hover:bg-teal-600 text-white"} disabled:opacity-50`,children:["Tandai ",t.status==="sudah diredeem"?"Belum":"Sudah"]})]}),e.jsxs("div",{className:"flex justify-between items-center text-xs text-gray-600 space-x-2",children:[e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsxs(K,{href:route("admin.manage-users.show",(i=t.user)==null?void 0:i.id),className:"flex items-center max-w-[100%] truncate text-blue-600 hover:underline",title:`${(N=t.user)==null?void 0:N.name}_RT:${(b=t.user)==null?void 0:b.rt}_RW:${(S=t.user)==null?void 0:S.rw}`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"w-4 h-4 mr-1",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16 7a4 4 0 0 1-8 0 4 4 0 0 1 8 0Zm-8 6a6 6 0 0 0-6 6h20a6 6 0 0 0-6-6H8Z"})}),(z=t.user)==null?void 0:z.name," ",(H=t.user)==null?void 0:H.rt,"/",(P=t.user)==null?void 0:P.rw]}),((U=(W=t.user)==null?void 0:W.pengelola_air)==null?void 0:U.nama)&&e.jsxs(K,{href:route("admin.pengelola-air.edit",t.user.pengelola_air.id),className:"flex items-center space-x-1 text-blue-500 text-[11px] italic hover:underline",title:`Edit data pengelola: ${t.user.pengelola_air.nama}`,children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",className:"w-3.5 h-3.5",viewBox:"0 0 16 16",children:[e.jsx("path",{"fill-rule":"evenodd",d:"M7.21.8C7.69.295 8 0 8 0q.164.544.371 1.038c.812 1.946 2.073 3.35 3.197 4.6C12.878 7.096 14 8.345 14 10a6 6 0 0 1-12 0C2 6.668 5.58 2.517 7.21.8m.413 1.021A31 31 0 0 0 5.794 3.99c-.726.95-1.436 2.008-1.96 3.07C3.304 8.133 3 9.138 3 10c0 0 2.5 1.5 5 .5s5-.5 5-.5c0-1.201-.796-2.157-2.181-3.7l-.03-.032C9.75 5.11 8.5 3.72 7.623 1.82z"}),e.jsx("path",{"fill-rule":"evenodd",d:"M4.553 7.776c.82-1.641 1.717-2.753 2.093-3.13l.708.708c-.29.29-1.128 1.311-1.907 2.87z"})]}),e.jsx("span",{children:t.user.pengelola_air.nama})]})]}),e.jsxs("div",{className:"flex items-center space-x-1 bg-gray-100 px-2 py-0.5 rounded-full whitespace-nowrap",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"w-4 h-4",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 7V3m8 4V3m-9 8h10m2 0a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2m14 0v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7"})}),e.jsx("span",{children:new Date(t.created_at).toLocaleString("id-ID",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})})]})]})]},t.id)}):e.jsx("p",{className:"p-4 text-center text-gray-500",children:"Belum ada penukaran voucher."})}),I>1&&e.jsxs("div",{className:"flex justify-center space-x-2 pb-8",children:[e.jsx("button",{onClick:()=>V(l-1),disabled:l===1,className:"px-3 py-1 rounded border border-gray-300 disabled:opacity-50",children:"Prev"}),[...Array(I).keys()].map(t=>{const r=t+1;return e.jsx("button",{onClick:()=>V(r),className:`px-3 py-1 rounded border ${l===r?"bg-main text-white":"border-gray-300"}`,children:r},r)}),e.jsx("button",{onClick:()=>V(l+1),disabled:l===I,className:"px-3 py-1 rounded border border-gray-300 disabled:opacity-50",children:"Next"})]})]}),u&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-80 flex justify-center items-center",children:e.jsxs("div",{className:"bg-white rounded-lg relative w-full max-w-sm mx-4 p-4 flex flex-col items-center",children:[e.jsx("div",{ref:x,id:"qr-reader",className:"w-full aspect-square bg-gray-200 rounded-lg"}),e.jsxs("div",{className:"flex space-x-2 mt-4",children:[j.length>1&&e.jsx("button",{onClick:$,className:"px-4 py-2 bg-blue-500 text-white rounded-lg",children:"Flip Camera"}),e.jsx("button",{onClick:()=>{M(),c(!1)},className:"px-4 py-2 bg-red-500 text-white rounded-lg",children:"Tutup"})]})]})})]})}export{xe as default};
