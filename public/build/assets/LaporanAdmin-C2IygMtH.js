import{q as L,r as n,j as e,a as M}from"./app-BjWjYO3P.js";function _(){const{laporan:f,userCount:b}=L().props,[d,N]=n.useState(""),[i,x]=n.useState(1),[m,y]=n.useState("desc"),[a,h]=n.useState({start:"",end:""}),[C,u]=n.useState(!1),p=n.useMemo(()=>{const s={};return f.forEach(t=>{s[t.periode]||(s[t.periode]={}),s[t.periode][t.user_id]||(s[t.periode][t.user_id]={user_name:t.user_name,sampah:[]}),s[t.periode][t.user_id].sampah.push({nama:t.sampah_nama,berat:t.total_berat})}),s},[f]),j=Object.keys(p).filter(s=>{const[t,l,r]=s.split("-"),c=new Date(`${r}-${l}-${t}`);return a.start&&c<new Date(a.start)||a.end&&c>new Date(a.end)?!1:d?Object.values(p[s]).some(o=>o.user_name.toLowerCase().includes(d.toLowerCase())):!0}).sort((s,t)=>{const l=s.split("-").reverse().join(""),r=t.split("-").reverse().join("");return m==="desc"?r-l:l-r}),w=10,g=Math.ceil(j.length/w),v=j.slice((i-1)*w,i*w);n.useEffect(()=>{x(1)},[d,m,a]);const k=s=>{const t=new Date(s);return t.setDate(t.getDate()+1),t.toISOString().split("T")[0]};return e.jsxs("div",{className:"mx-auto w-full max-w-[500px] min-h-screen bg-gray-50",children:[e.jsx(M,{title:"Laporan Admin"}),e.jsxs("div",{className:"fixed top-0 left-1/2 -translate-x-1/2 max-w-[500px] w-full z-10 bg-main",children:[e.jsxs("div",{className:"w-full flex flex-row space-x-4 justify-start items-center px-4 py-2 bg-main",children:[e.jsxs("div",{className:"w-full flex flex-row space-x-4 items-center justify-start",children:[e.jsx("button",{className:"shrink-0 w-6 h-6",onClick:()=>window.history.back(),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"white",className:"w-6 h-6",children:e.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),e.jsx("div",{className:"font-utama text-white font-bold text-lg",children:"Laporan Admin"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:()=>window.open(route("admin.laporan.export.excel"),"_blank"),className:"text-white p-2 rounded-full hover:bg-main_dark transition",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"white",viewBox:"0 0 16 16",children:e.jsx("path",{d:"M9.293 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4.707A1 1 0 0 0 13.707 4L10 .293A1 1 0 0 0 9.293 0M9.5 3.5v-2l3 3h-2a1 1 0 0 1-1-1m-1 4v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 0 1 .708-.708L7.5 11.293V7.5a.5.5 0 0 1 1 0"})})})})]}),e.jsxs("div",{className:"w-full h-max flex flex-col space-y-4 items-center justify-start p-4 bg-white shadow-lg",children:[e.jsxs("div",{className:"w-full h-9 flex flex-row mx-auto items-center justify-center pr-2 py-2 rounded-lg bg-neutral-100 border-2 border-gray-200",children:[e.jsx("input",{id:"searchInput",type:"text",className:"bg-transparent border-none flex-grow focus:ring-0 focus:outline-none placeholder-gray-400",placeholder:"Cari nama pengguna",value:d,onChange:s=>N(s.target.value)}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"0.3",className:"w-5 h-5 text-main",children:e.jsx("path",{d:"M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16a6.471 6.471 0 0 0 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zM9.5 14A4.5 4.5 0 1 1 14 9.5 4.505 4.505 0 0 1 9.5 14z"})})]}),e.jsxs("div",{className:"w-full flex flex-row space-x-4 items-center",children:[e.jsxs("button",{onClick:()=>y(s=>s==="desc"?"asc":"desc"),className:"w-full flex flex-row space-x-2 items-center justify-center px-4 py-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",className:"w-4 h-4 text-main",viewBox:"0 0 16 16",children:e.jsx("path",{fillRule:"evenodd",d:"M8 1a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L7.5 13.293V1.5A.5.5 0 0 1 8 1"})}),e.jsx("span",{className:"text-utama text-sm font-thin text-main",children:m==="desc"?"Terbaru":"Terlama"})]}),e.jsx("div",{className:"shrink-0 w-px bg-main h-6"}),e.jsxs("button",{onClick:()=>u(!0),className:"w-full flex flex-row space-x-2 items-center justify-center px-4 py-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",className:"w-4 h-4 text-main",children:e.jsx("path",{d:"M1.5 1.5A.5.5 0 0 1 2 1h12a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.128.334L10 8.692V13.5a.5.5 0 0 1-.342.474l-3 1A.5.5 0 0 1 6 14.5V8.692L1.628 3.834A.5.5 0 0 1 1.5 3.5z"})}),e.jsx("span",{className:"text-utama text-sm font-thin text-main",children:"Filter"})]})]})]})]}),e.jsx("div",{className:"pt-[200px] px-4 pb-16",children:v.length>0?v.map((s,t)=>{var l;return e.jsxs("div",{className:"mb-6 bg-white rounded-lg shadow p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-700",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",className:"w-4 h-4 mr-1 text-blue-500",viewBox:"0 0 16 16",children:e.jsx("path",{d:"M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"})}),e.jsxs("span",{children:["Total Pengguna: ",e.jsx("b",{children:((l=b[s])==null?void 0:l.total_user_setor)||0})]})]}),e.jsxs("div",{className:"flex items-center font-bold text-sm text-right text-gray-800",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",className:"w-4 h-4 mr-1 text-main",viewBox:"0 0 16 16",children:e.jsx("path",{d:"M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h.5A1.5 1.5 0 0 1 15 2.5v11A1.5 1.5 0 0 1 13.5 15h-11A1.5 1.5 0 0 1 1 13.5v-11A1.5 1.5 0 0 1 2.5 1H3V.5a.5.5 0 0 1 .5-.5zM14 4H2v9.5a.5.5 0 0 0 .5.5h11a.5.5 0 0 0 .5-.5V4z"})}),e.jsx("span",{children:s})]})]}),Object.entries(p[s]).map(([r,c])=>e.jsxs("div",{className:"mb-3 border rounded p-3 cursor-pointer hover:bg-gray-100",onClick:()=>window.location.href=`/admin/view-users/${r}`,children:[e.jsx("p",{className:"font-semibold text-sm mb-2",children:c.user_name}),e.jsx("ul",{className:"ml-4 list-disc text-sm text-gray-700",children:c.sampah.map((o,A)=>e.jsxs("li",{children:[o.nama," : ",Number(o.berat).toLocaleString("id-ID")," kg"]},A))})]},r))]},t)}):e.jsx("p",{className:"text-center py-6 text-gray-500",children:"Tidak ada data laporan."})}),e.jsxs("div",{className:"fixed bottom-0 left-1/2 -translate-x-1/2 max-w-[500px] w-full bg-white border-t shadow-inner p-4 flex justify-between items-center",children:[e.jsx("button",{onClick:()=>x(s=>Math.max(s-1,1)),disabled:i===1,className:"px-4 py-2 border rounded disabled:opacity-50",children:"Sebelumnya"}),e.jsxs("span",{className:"text-sm",children:["Halaman ",i," dari ",g]}),e.jsx("button",{onClick:()=>x(s=>Math.min(s+1,g)),disabled:i===g,className:"px-4 py-2 border rounded disabled:opacity-50",children:"Selanjutnya"})]}),C&&e.jsx("div",{className:"fixed h-screen px-4 inset-0 z-20 flex items-center justify-center bg-gray-800 bg-opacity-50",children:e.jsx("div",{className:"w-full max-w-[328px] p-4 bg-white rounded-lg shadow-lg",children:e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsx("button",{className:"flex justify-end",onClick:()=>u(!1),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",className:"w-7 h-7 text-red-500",viewBox:"0 0 16 16",children:e.jsx("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293z"})})}),e.jsx("h2",{className:"text-center text-utama text-lg font-medium",children:"Filter Tanggal"}),e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-utama",children:"Tanggal Mulai"}),e.jsx("input",{type:"date",className:"text-sm px-3 py-2 border rounded-md bg-neutral-100",value:a.start,onChange:s=>h({...a,start:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-utama",children:"Tanggal Akhir"}),e.jsx("input",{type:"date",className:"text-sm px-3 py-2 border rounded-md bg-neutral-100",value:a.end,min:a.start?k(a.start):"",onChange:s=>h({...a,end:s.target.value})})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 mt-2",children:[e.jsx("button",{onClick:()=>h({start:"",end:""}),className:"border border-red-300 text-red-500 py-2 rounded hover:bg-red-50 transition",children:"Reset Tanggal"}),e.jsx("button",{onClick:()=>u(!1),className:"bg-blue-600 text-white py-2 rounded hover:bg-blue-700 transition",children:"Terapkan"})]})]})})})]})}export{_ as default};
